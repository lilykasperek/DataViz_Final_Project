---
title: "final_project_draft"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Written Description 
The general purpose of this project is to curate many different data visualizations using a variety of data sets. I want to create a personal website using blogdown to share these data visualizations. I decided to use data that was interesting to me, and found that I was most interested in data examining the political donations made by professional sport team owners from different leagues. 

Data Ethics: 
* Political donations are public information; scraped the data from Kaggle, did not realize until today (April 10th) that fivethirtyeright actually published a piece using this data but luckily the visualizations that I have already made are different from those on fivethirtyeight 
* did not exclude N/A for a party affiliation point because I did not think there was any reason other than making the legend look better 

Expressing Variability:
* Use scatter plots to show variability in data, and use bar plots to show the count of categorical variables 

Motivation and Grammar of Graphics:
* Used theme() for the style of my visualizations 

## Political Donations of Professional Sports Team Owners 
```{r, message = FALSE, warning = FALSE, echo = FALSE}
library(tidyverse)
library(ggthemes)

pol_donations <- read_csv("/Users/lilykasperek/Desktop/my-website/content/post/2022-03-22-first-post/sports-political-donations.csv")

pol_donations <- pol_donations %>% rename(year = 'Election Year') %>% mutate(amount = parse_number(Amount)) %>% 
  mutate(Recipient = fct_recode(Recipient, Hillary_Victory_Fund = "HILLARY VICTORY FUND", 
                                Hillary_Victory_Fund = "Hillary Victory Fund",
                                Office_Of_Commissioner_of_MLB_PAC = "Office of the Commissioner of Major League Baseball PAC",
                                Office_Of_Commissioner_of_MLB_PAC = "OFFICE OF THE COMMISSIONER OF MAJOR LEAGUE BASEBALL POLITICAL ACTION COMMITTEE"))

library(plotly)
options(scipen = 10)
library(ggpmisc)
library(ggrepel)
```

## Questions: What were the highest 25 Political Donations made by NFL team owners in 2016? Were the majority of these donations affiliated with a certain party? How much influence could NFL team owners have on elections? Is there any gender that dominates?
```{r, message = FALSE, warning = FALSE, echo = FALSE}
high_donations <- pol_donations %>% filter(year == "2016" & League == "NFL") %>%
  mutate(amount = parse_number(Amount)) %>%
  arrange(desc(amount)) %>%
  mutate(Rank = rank(desc(amount))) %>%
  filter(Rank <= 25) %>%
  mutate(owner_ordered = fct_reorder(.f = Owner, .x = amount)) %>%
  mutate(party = fct_relevel(Party, c("Republican", "Democrat", "Bipartisan")))

ggplot(data = high_donations, aes(x = amount, y = owner_ordered, label = Recipient, colour = party)) +
  geom_point(size = 2) +
  labs(x = " ", 
       y = " ",
       title = "How Much Did NFL Owners Donate in 2016?",
       colour = "Political Party",
       subtitle = "What Influence Could NFL Team Owners Have on Elections?") +
  scale_colour_viridis_d() +
  theme_bw() +
  theme(plot.title = element_text(family = "mono",
                                  face = "bold",
                                  size = 15,
                                  margin = margin(c(t = 20,
                                                    b = 50,
                                                    vjust = 10))),
        plot.subtitle = element_text(family = "mono",
                                     face = "italic",
                                     size = 10),
        legend.title = element_text(family = "mono",
                                    face = "bold",
                                    size = 8),
        legend.text = element_text(family = "mono",
                                   size = 8),
        axis.text = element_text(family = "mono",
                                 size = 8),
        legend.box.background = element_rect(),
        legend.position = "bottom") 
```

## Questions: Which owners, across all leagues, have made the most political donations from this data set? How many have they made? Is there a certain gender that dominates? 
```{r}
library(knitr)
library(pander)
library(tidyverse)
library(kableExtra)

owner_rank2 <- pol_donations %>% group_by(Owner, Team, League) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) %>%
  filter(n >= 65)

kable(owner_rank2, caption = "<b>Who Makes the Most Donations Across All Leagues?<b>", format = "html",
      col.names = c("Owner", "Team", "League", "Donations Made")) %>%
  kable_styling(html_font = "Cambria", bootstrap_options = "striped",
                font_size = 9) 
```

## Questions: How much money was spent for these donations? Do these donations tend to be made to the same party for each owner or do they vary? What is the total sum of the donations made by these individuals? What is the average amount per donation? 
```{r, message = FALSE, warning = FALSE, echo = FALSE}
owner_rank <- pol_donations %>% group_by(Owner, League) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) 

frequent <- pol_donations %>% group_by(Owner) %>%
  mutate(n = n()) %>%
  filter(n >= 65) %>%
  arrange(desc(n)) %>%
  mutate(donations = as.numeric(n))

frequent %>% group_by(Party) %>%
  summarise(n = n()) %>%
  arrange(desc(n))

average_donation <- frequent %>% group_by(Owner) %>%
  mutate(mean = mean(amount))
average_donation 

ggplot(data = frequent, aes(x = amount, y = level_order, label = Amount, colour = Party)) +
  geom_point() +
  geom_point(data = average_donation, aes(x = mean, colour = "Mean")) +
  scale_colour_manual(values = c("Mean" = "Red"))

level_order <- factor(frequent$Owner, level = c('Stephen M. Ross', 'Herbert Simon',
                                                'Jerry Reinsdorf', 'Ken Kendrick',
                                                'Jimmy and Susan Haslam',
                                                'Jody Allen (Paul G. Allen Trust)',
                                                'Dan DeVos', 'John Rogers',
                                                'Micky Arison', 'Charles Johnson'))

ggplot(data = frequent, aes(x = amount, y = level_order, label = Amount, colour = Party)) +
  geom_point() +
  labs(title = "How Many Donations Have They Made?",
       subtitle = "Examining The Monetary Amount of Observed Political Donations",
       y = " ",
       x = " ",
       colour = "Party") +
  scale_colour_brewer(palette = "Dark2") +
    theme_bw() +
  theme(legend.position = "bottom",
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  size = 12),
        axis.text.x = element_text(family = "mono"),
        axis.text.y = element_text(family = "mono"),
        legend.title = element_text(family = "mono", 
                                    face = "bold",
                                    size = 5),
        legend.text = element_text(family = "mono",
                                   size = 5),
        plot.subtitle = element_text(family = "mono",
                                     face = "italic",
                                     size = 9),
        legend.box.background = element_rect())

ggplot(data = frequent, aes(x = amount, y = level_order, label = Amount, colour = Party)) +
  geom_point() +
  geom_point(data = average_donation, aes(x = mean, colour = "Mean Donations")) +
  labs(title = "How Many Donations Have They Made?",
       subtitle = "Examining The Monetary Amount of Observed Political Donations",
       y = " ",
       x = " ",
       colour = "Party") +
  scale_colour_brewer(palette = "Dark2") +
  scale_colour_manual(values = c("Mean Donations" = "red")) +
    theme_bw() +
  theme(legend.position = "bottom",
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  size = 12,
                                  margin = margin(c(t = 50,
                                                    b = 50)),
                                  vjust = 10),
        axis.text.x = element_text(family = "mono"),
        axis.text.y = element_text(family = "mono"),
        legend.title = element_text(family = "mono", 
                                    face = "bold",
                                    size = 7),
        legend.text = element_text(family = "mono",
                                   size = 6),
        plot.subtitle = element_text(family = "mono",
                                     face = "italic",
                                     size = 9,
                                     vjust = 5),
        legend.box.just = "left",
        legend.box.background = element_rect())

ggplot(data = frequent, aes(x = amount, y = level_order, label = Amount, colour = Party)) +
  geom_point() +
  geom_point(data = average_donation, aes(x = mean, colour = "Mean Donations")) +
  labs(title = "How Many Donations Have They Made?",
       subtitle = "Examining The Monetary Amount of Observed Political Donations",
       y = " ",
       x = " ",
       colour = "Party") +
  scale_colour_viridis_d() +
    theme_bw() +
  theme(legend.position = "bottom",
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  size = 12,
                                  margin = margin(c(t = 50,
                                                    b = 50)),
                                  vjust = 10),
        axis.text.x = element_text(family = "mono"),
        axis.text.y = element_text(family = "mono"),
        legend.title = element_text(family = "mono", 
                                    face = "bold",
                                    size = 7),
        legend.text = element_text(family = "mono",
                                   size = 6),
        plot.subtitle = element_text(family = "mono",
                                     face = "italic",
                                     size = 9,
                                     vjust = 5),
        legend.box.just = "left",
        legend.box.background = element_rect()) 


  scale_fill_discrete(limits = c("Republican", "Democrat", 
                                      "Bipartisan, but mostly Republican", 
                                      "Bipartisan", "N/A",
                                      "Bipartisan, but mostly Democratic",
                                      "Independent", 
                                      "Mean Donations"))

frequent %>% mutate(party = fct_relevel(Party, c("Republican", "Democrat", 
                                      "Bipartisan, but mostly Republican", 
                                      "Bipartisan", "N/A",
                                      "Bipartisan, but mostly Democratic",
                                      "Independent", 
                                      "Mean Donations")))

sum_donations <- frequent %>% group_by(Owner) %>%
  summarise(sum = sum(amount)) %>%
  rename(Sum = 'sum') %>%
  arrange(desc(Sum))
sum_donations

pandoc.table(sum_donations, style = "grid")
```

## Questions: How many donations, out of the 213 made by Charles Johnson, were made to which political parties? 
```{r}
library(ggthemes)
charles_johnson <- pol_donations %>% filter(Owner == "Charles Johnson") %>%
  filter(year == 2016 | year == 2018 | year == 2020) 

 cj_party <- charles_johnson %>% group_by(Party) %>%
  summarise(n = n()) %>%
  mutate(party = fct_reorder(.f = Party, .x = n)) %>%
   mutate(Party = fct_relevel(party, c("Democrat", "Bipartisan, but mostly Republican", "Republican")))

level_order2 <- factor(charles_johnson$Party, level = c('Democrat', 'Bipartisan, but mostly Republican', 'Republican'))

ggplot(data = cj_party, aes(x = party, y = n, fill = Party)) +
  geom_col() +
  scale_fill_viridis_d(option = "inferno") +
  labs(title = "Party Affiliation of Political Donations Made by Charles Johnson",
       x = " ",
       y = " ") +
  theme(legend.position = "bottom",
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  hjust = 0.5,
                                  size = 13,
                                  margin = margin(c(t = 50,
                                                    b = 50)),
                                  vjust = 10),
        axis.text = element_text(family = "mono"),
        legend.title = element_text(family = "mono",
                                    face = "bold"),
        legend.text = element_text(family = "mono"),
        axis.ticks.y = element_blank(),
        axis.ticks.x = element_blank(),
        axis.title.x = element_text(family = "mono",
                                    size = 9,
                                    face = "italic",
                                    margin = margin(t = 20)),
        axis.title.y = element_text(family = "mono",
                                    margin = margin(t = 20, b = 20, r = 20)))

table_cjparty <- cj_party %>% arrange(desc(n)) %>%
  select(Party, n) %>%
  rename(Count = 'n')
pandoc.table(table_cjparty)
```

## Question: As we can see, most of the donations made by Charles Johnson were affiliated with the Republican party. What were some of these organizations and how many donations did Charles Johnson make to each of these organizations? 
```{r}
organizations <- charles_johnson %>% group_by(Recipient, Party) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) %>%
  filter(n >= 2)

kable(organizations, caption = "<b>What Are Some Organizations Charles Johnson Donates To?<b>",
      col.names = c("Recipient", "Political Party", "Amount of Donations Made"))  %>%
  kable_styling(html_font = "Cambria", bootstrap_options = "striped",
                font_size = 15) %>%
  scroll_box(height = "500px")
```

## Questions: What are some organizations that seem to be recieving the most donations across all owners and leagues? What political party are these organizations affiliated with? 
```{r}
recipients <- pol_donations %>% group_by(Recipient, Party) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) %>%
  filter(n >= 15) %>%
  ungroup() %>%
  mutate(recipient = fct_reorder(.f = Recipient, .x = n)) %>%
  mutate(Party = fct_relevel(Party, c("Bipartisan", "Republican", "Democrat")))

new_names <- c("Collins For Senator", "McSally for Senate Inc.",
               "ActBlue", "Portman For Senate Committee", "NRCC",
               "NRSC", "Hillary Victory Fund", "Team Ryan", 
               "Office of the Commissioner of MLB PAC", "Gridirion PAC")

ggplot(data = recipients, aes(x = recipient, y = n, fill = Party)) +
  geom_col() +
  coord_flip() +
  labs(x = " ",
       y = "Count of Donations") +
  labs(title = "Organizations Receiving Most Donations Among All Owners") +
  scale_fill_brewer(palette = "Dark2") +
  theme(legend.position = "bottom") +
  scale_x_discrete(labels = new_names) +
  theme(plot.title = element_text(family = "mono",
                                  face = "bold",
                                  margin = margin(c(t = 50,
                                                    b = 50)),
                                  vjust = 10),
        axis.text = element_text(family = "mono"),
        axis.title = element_text(family = "mono",
                                  size = 8),
        axis.title.x = element_text(size = 10,
                                    margin = margin(t = 20,
                                                    b = 10)),
        legend.title = element_text(family = "mono",
                                    face = "bold"),
        legend.text = element_text(family = "mono"),
        axis.ticks = element_blank(),
         legend.box.background = element_rect())

pol_donations %>% group_by(League) %>%
  summarise(n = n()) %>%
  arrange(desc(n))
```

## Forbes Billionaires 2021

## Average networth of billionaires by industry? 

## Questions: Who were the billionaires with the top 10 highest net worths on the 2021 Forbes Billionaires List? How much are their net worths? What industry do they work in? Does any industry dominate the others? 
```{r}
billionaires <- read_csv("data/Billionaire.csv")
billionaires
forbes_billionaires <- read_csv("data/forbes_billionaires.csv")
forbes_billionaires 

top10 <- billionaires %>% filter(Rank <= 10) %>%
  mutate(NetWorth = parse_number(NetWorth)) %>%
  mutate(order = fct_reorder(.f = Name, .x = NetWorth)) %>%
  mutate(Industry = fct_relevel(Industry, c("Technology",
                                            "Automotive",
                                            "Fashion & Retail", 
                                            "Finance & Investments", 
                                            "Diversified")))
top10

new_names2 <- c("Mukesh Ambani", "Sergey Brin", "Larry Page", "Larry Ellison",
                "Warren Buffett", "Mark Zuckerberg", "Bill Gates", 
                "Bernard Arnault & Family", "Elon Musk", "Jeff Bezos")

ggplot(data = top10, aes(x = order, y = NetWorth, fill = Industry)) +
  geom_col() +
  coord_flip() +
  labs(x = "Billionaire Name", 
       y = "Net Worth",
       caption = "Measured in Billions",
       colour = "Industry",
       title = "2021 Forbes Billionaires with the Highest Net Worth") +
  scale_fill_viridis_d() +
  scale_x_discrete(labels = new_names2) +
  theme(axis.title = element_text(family = "mono",
                                  face = "bold"),
        axis.text = element_text(family = "mono"),
        axis.ticks = element_blank(),
        plot.title = element_text(family = "mono",
                                  face = "bold"),
        legend.title = element_text(family = "mono",
                                    face = "bold"),
        legend.text = element_text(family = "mono",
                                   face = "italic"),
        plot.caption = element_text(family = "mono",
                                    face = "italic"))
```

## Questions: What is the average age of the billionaires from the 10 countries with the most billionaires? Is there a pattern or do the averages widely differ? Are there any interesting outliers? 
```{r}
forbes_billionaires_age <- forbes_billionaires %>%
  mutate(age = as.numeric(Age)) %>%
  select(age, everything())

countries_10 <- forbes_billionaires_age %>% filter(Country == "United States" |
           Country == "China" |
           Country == "India" |
           Country == "Germany" |
           Country == "Russia" |
           Country == "Hong Kong" |
           Country == "Brazil" |
           Country == "Canada" |
           Country == "United Kingdom" |
           Country == "Italy") 
countries_10

ggplot(data = countries_10, aes(x = Country, y = age)) +
  geom_point() +
  coord_flip() 

check <- countries_10 %>% filter(age < 25 | age > 97)
check

filter <- countries_10 %>% filter(!is.na(age))
filter
filter2 <- filter %>% group_by(Country) %>%
  summarise(Average = mean(age)) %>%
  mutate(order = fct_reorder(.f = Country, .x = Average))
filter2

ggplot(data = countries_10, aes(x = Country, y = age)) +
  geom_point(alpha = 0.4) +
  coord_flip() +
  geom_point(data = filter2, aes(x = order, y = Average, colour = "Mean Age"),
             size = 2.5) +
  scale_colour_manual(values = c("Mean Age" = "red")) +
  labs(x = "Country", 
       y = "Age",
       title = "Average Age of Billionaires by Country",
       caption = "The Red Points Indicate the Average Age of Billionaires From Each
       Country") +
  theme(axis.title = element_text(family = "mono",
                                  face = "bold"),
        axis.text = element_text(family = "mono"),
        plot.title = element_text(family = "mono",
                                  face = "bold"),
        axis.ticks = element_blank(),
        legend.title = element_blank(),
        legend.text = element_text(family = "mono",
                                   face = "italic"),
        legend.position = "none",
        plot.caption = element_text(family = "mono",
                                    size = 9,
                                    face = "italic")) +
  geom_label_repel(data = check, aes(label = age, family = "mono"))
```

## Average net worth per industry 
```{r}
forbes_billionaires %>% group_by(Country) %>%
  summarise(avg = mean(NetWorth))

usa_df <- billionaires %>% filter(Country == "United States") %>% mutate(networth = parse_number(NetWorth)) 
usa_df

usa_df %>% group_by(Industry) %>%
  summarise(n = n()) %>%
  arrange(desc(n))

usa_avg_df <- usa_df %>%
   summarise(avg = mean(networth))
usa_avg_df

above_or_below_us <- usa_df %>% mutate(avg = mean(networth)) %>%
  mutate(above_avg = if_else(networth > 6.08,
                                      true = "ABOVE AVG",
                                      false = "BELOW AVG")) %>%
  filter(Industry == "Fashion & Retail") %>%
  mutate(order = fct_reorder(.f = Name, .x = networth))
above_or_below_us 

ggplot(data = above_or_below_us, aes(x = order, y = networth, colour = above_avg)) +
  geom_segment(aes(x = order, xend = order, y = avg, yend = networth)) +
  geom_point() +
  coord_flip() +
  labs(x = "Name",
      y = "Net Worth",
      colour = "Average") +
  theme(axis.text = element_text(family = "mono"),
        axis.title = element_text(family = "mono"),
        legend.text = element_text(family = "mono"),
        legend.title = element_text(family = "mono"),
        axis.ticks = element_blank())
```

## Questions: How many billionaires are there from the top 30 countries on the list? Do developed democracies have the most billionaires on the list?
```{r}
country <- forbes_billionaires %>% group_by(Country) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) 

country_30 <- country %>% slice(1:30) %>%
  mutate(order = fct_reorder(.f = Country, .x = n))
country_30

ggplot(data = country_30, aes(x = order, y = n)) +
  geom_point(colour = "orange") +
  geom_segment(aes(x = order, xend = order, y = 0, yend = n), colour = "blue", linetype = "dotdash") +
  coord_flip() +
  theme_light() +
  theme(axis.ticks.x = element_blank()) +
  labs(x = "Country", 
       y = "Count of Billionaires",
       title = "How Many Billionaires Are There From the Top 30 Countries?") +
  theme(plot.title = element_text(family = "mono"),
        axis.text = element_text(family = "mono"),
        axis.title = element_text(family = "mono"))
```

## Playing Around with New Variables 
```{r}
self_made <- forbes_billionaires %>% group_by(Self_made) %>%
  summarise(n = n()) 

ggplot(data = forbes_billionaires, aes(x = Self_made)) +
  geom_bar()

industry <- billionaires %>% group_by(Industry) %>%
  summarise(n = n()) %>%
  arrange(desc(n))
industry

combined_billionaires <- left_join(forbes_billionaires, billionaires, by = c("Name" = "Name"))
combined_billionaires

usa_billionaires <- combined_billionaires %>% filter(Country.x == "United States")
ggplot(data = usa_billionaires, aes(x = Self_made)) +
  geom_bar() 

forbes_billionaires %>% group_by(Status) %>%
  summarise(n = n()) %>%
  arrange(desc(n))

tidy_education <- forbes_billionaires %>% 
  separate(col = Education, into = c("Degree", "University"),
                                 sep = ", ") %>%
  select(Degree, University, everything())
tidy_education

tidy_education %>% group_by(Degree) %>%
  summarise(n = n()) %>%
  arrange(desc(n))

tidy_education2 <- tidy_education %>% filter(Degree == "Bachelor of Arts/Science" |
                          Degree == "Master of Business Administration" |
                          Degree == "Master of Science" |
                          Degree == "Drop Out" |
                          Degree == "Bachelor of Science" |
                          Degree == "Bachelor of Science in Engineering" |
                          Degree == "Doctorate" |
                          Degree == "Diploma" |
                          Degree == "Bachelor of Arts/Economic")

ggplot(data = tidy_education2, aes(x = Degree, y = NetWorth)) +
  geom_point(alpha = 0.4) +
  coord_flip() +
  labs(x = "Education Level",
       y = "Net Worth")

ggplot(data = tidy_education2, aes(x = Degree, y = NetWorth)) +
  geom_jitter(alpha = 0.4) +
  coord_flip() +
  labs(x = "Education Level",
       y = "Net Worth")
```

## Forbes Billionaire 2021 3.0 Data Set 
```{r}
forbes_billionaires_geo <- read_csv("data/forbes_billionaires_geo.csv")
forbes_billionaires_geo 
```

