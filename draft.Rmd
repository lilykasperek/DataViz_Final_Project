---
title: "final_project_draft"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Political Donations of Professional Sports Team Owners 
```{r, message = FALSE, warning = FALSE, echo = FALSE}
library(tidyverse)
library(ggthemes)

pol_donations <- read_csv("/Users/lilykasperek/Desktop/my-website/content/post/2022-03-22-first-post/sports-political-donations.csv")

pol_donations <- pol_donations %>% rename(year = 'Election Year') %>% mutate(amount = parse_number(Amount)) %>% 
  mutate(Recipient = fct_recode(Recipient, Hillary_Victory_Fund = "HILLARY VICTORY FUND", 
                                Hillary_Victory_Fund = "Hillary Victory Fund",
                                Office_Of_Commissioner_of_MLB_PAC = "Office of the Commissioner of Major League Baseball PAC",
                                Office_Of_Commissioner_of_MLB_PAC = "OFFICE OF THE COMMISSIONER OF MAJOR LEAGUE BASEBALL POLITICAL ACTION COMMITTEE"))

library(plotly)
options(scipen = 10)
## install.packages("ggpmisc")
library(ggpmisc)
```

## Top 25 Highest Political Donations by NFL Team Owners in 2016 
```{r, message = FALSE, warning = FALSE, echo = FALSE}
high_donations <- pol_donations %>% filter(year == "2016" & League == "NFL") %>%
  mutate(amount = parse_number(Amount)) %>%
  arrange(desc(amount)) %>%
  mutate(Rank = rank(desc(amount))) %>%
  filter(Rank <= 25) %>%
  mutate(owner_ordered = fct_reorder(.f = Owner, .x = amount)) %>%
  mutate(party = fct_relevel(Party, c("Republican", "Democrat", "Bipartisan")))

ggplot(data = high_donations, aes(x = amount, y = owner_ordered, label = Recipient, colour = party)) +
  geom_point(size = 2) +
  labs(x = " ", 
       y = " ",
       title = "How Much Did NFL Owners Donate in 2016?",
       colour = "Political Party",
       subtitle = "What Influence Could NFL Team Owners Have on Elections?") +
  scale_colour_viridis_d() +
  theme_bw() +
  theme(plot.title = element_text(family = "mono",
                                  face = "bold",
                                  size = 15,
                                  margin = margin(c(t = 20,
                                                    b = 50,
                                                    vjust = 10))),
        plot.subtitle = element_text(family = "mono",
                                     face = "italic",
                                     size = 10),
        legend.title = element_text(family = "mono",
                                    face = "bold",
                                    size = 8),
        legend.text = element_text(family = "mono",
                                   size = 8),
        axis.text = element_text(family = "mono",
                                 size = 8),
        legend.box.background = element_rect(),
        legend.position = "bottom") 
```

## Table of Owners Who Make the Most Donations
```{r}
library(knitr)
library(pander)
library(tidyverse)
library(kableExtra)

owner_rank2 <- pol_donations %>% group_by(Owner, Team, League) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) %>%
  filter(n >= 65)

kable(owner_rank2, caption = "<b>Who Makes the Most Donations Across All Leagues?<b>", format = "html",
      col.names = c("Owner", "Team", "League", "Donations Made")) %>%
  kable_styling(html_font = "Cambria", bootstrap_options = "striped",
                font_size = 9) 
```

## How Much Do They Donate? 
```{r, message = FALSE, warning = FALSE, echo = FALSE}
owner_rank <- pol_donations %>% group_by(Owner, League) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) 
 
frequent <- pol_donations %>% group_by(Owner) %>%
  mutate(n = n()) %>%
  filter(n >= 65) %>%
  arrange(desc(n)) %>%
  mutate(donations = as.numeric(n))

level_order <- factor(frequent$Owner, level = c('Stephen M. Ross', 'Herbert Simon',
                                                'Jerry Reinsdorf', 'Ken Kendrick',
                                                'Jimmy and Susan Haslam',
                                                'Jody Allen (Paul G. Allen Trust)',
                                                'Dan DeVos', 'John Rogers',
                                                'Micky Arison', 'Charles Johnson'))

ggplot(data = frequent, aes(x = amount, y = level_order, label = Amount, colour = Party)) +
  geom_point() +
  labs(title = "How Many Donations Have They Made?",
       subtitle = "Examining The Monetary Amount of Observed Political Donations",
       y = " ",
       x = " ",
       colour = "Party") +
  scale_colour_brewer(palette = "Dark2") +
    theme_bw() +
  theme(legend.position = "bottom",
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  size = 12,
                                  margin = margin(c(t = 50,
                                                    b = 50)),
                                  vjust = 10),
        axis.text.x = element_text(family = "mono"),
        axis.text.y = element_text(family = "mono"),
        legend.title = element_text(family = "mono", 
                                    face = "bold",
                                    size = 7),
        legend.text = element_text(family = "mono",
                                   size = 6),
        plot.subtitle = element_text(family = "mono",
                                     face = "italic",
                                     size = 9,
                                     vjust = 5),
        legend.box.just = "left",
        legend.box.background = element_rect())
```

## Examining Top Donator 
```{r}
library(ggthemes)
charles_johnson <- pol_donations %>% filter(Owner == "Charles Johnson") %>%
  filter(year == 2016 | year == 2018 | year == 2020) 

cj_party <- charles_johnson %>% group_by(Party) %>%
  summarise(n = n()) %>%
  mutate(party = fct_reorder(.f = Party, .x = n)) %>%
   mutate(Party = fct_relevel(party, c("Republican", "Bipartisan, but mostly Republican",
                                         "Democrat")))

level_order2 <- factor(charles_johnson$Party, level = c('Republican', 'Democrat', 'Bipartisan, but mostly Republican'))

ggplot(data = cj_party, aes(x = party, y = n, fill = Party)) +
  geom_col() +
  coord_flip() +
  scale_fill_viridis_d(option = "plasma") +
  labs(title = "Is There Any Political Party Receiving More Support From Charles Johnson?",
       x = " ",
       y = "Count of Donations") +
  theme(legend.position = "bottom",
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  hjust = 0.5,
                                  size = 13,
                                  margin = margin(c(t = 50,
                                                    b = 50)),
                                  vjust = 10),
        axis.text = element_text(family = "mono"),
        legend.title = element_text(family = "mono",
                                    face = "bold"),
        legend.text = element_text(family = "mono"),
        axis.ticks.y = element_blank(),
        axis.ticks.x = element_blank(),
        axis.title.x = element_text(family = "mono",
                                    size = 9,
                                    face = "italic",
                                    margin = margin(t = 20))) 

table <- data.frame(Party = rep(c("Republican", "Bipartisan, but mostly Republican",
                                "Democrat", each = 1),
                              Count = rep(c("207", "4", "2"), 1)))
table

ggplot(data = cj_party, aes(x = party, y = n, fill = Party)) +
  geom_col() + 
  annotate(geom = "table") +
  coord_flip()
```

## What Are Some of These Organizations? 
```{r}
organizations <- charles_johnson %>% group_by(Recipient, Party) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) %>%
  filter(n >= 2)

kable(organizations, caption = "<b>What Are Some Organizations Charles Johnson Donates To?<b>",
      col.names = c("Recipient", "Political Party", "Amount of Donations Made"))  %>%
  kable_styling(html_font = "Cambria", bootstrap_options = "striped",
                font_size = 15) %>%
  scroll_box(height = "500px")
```

## Organizations Receiving Most Donations Across All Leagues 
```{r}
recipients <- pol_donations %>% group_by(Recipient, Party) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) %>%
  filter(n >= 15) %>%
  ungroup() %>%
  mutate(recipient = fct_reorder(.f = Recipient, .x = n)) %>%
  mutate(Party = fct_relevel(Party, c("Bipartisan", "Republican", "Democrat")))

new_names <- c("Collins For Senator", "McSally for Senate Inc.",
               "ActBlue", "Portman For Senate Committee", "NRCC",
               "NRSC", "Hillary Victory Fund", "Team Ryan", 
               "Office of the Commissioner of MLB PAC", "Gridirion PAC")

ggplot(data = recipients, aes(x = recipient, y = n, colour = Party)) +
  geom_point() +
  geom_segment(aes(x = recipient, xend = recipient, y = 0, yend = n)) +
  coord_flip() +
  labs(x = " ",
       y = "Count of Donations") +
  labs(title = "Organizations Receiving Most Donations Among All Owners") +
  scale_colour_brewer(palette = "Dark2") +
  theme(legend.position = "bottom") +
  scale_x_discrete(labels = new_names) +
  theme(plot.title = element_text(family = "mono",
                                  face = "bold",
                                  margin = margin(c(t = 50,
                                                    b = 50)),
                                  vjust = 10),
        axis.text = element_text(family = "mono"),
        axis.title = element_text(family = "mono",
                                  size = 8),
        axis.title.x = element_text(size = 10,
                                    margin = margin(t = 20,
                                                    b = 10)),
        legend.title = element_text(family = "mono",
                                    face = "bold"),
        legend.text = element_text(family = "mono"),
        axis.ticks = element_blank(),
         legend.box.background = element_rect())

pol_donations %>% group_by(League) %>%
  summarise(n = n()) %>%
  arrange(desc(n))
```

## Blockbusters: A blockbuster is a Hollywood movie that's made with a large budget and big stars. A true blockbuster is extremely popular and brings in a lot of money (https://www.vocabulary.com/dictionary/blockbuster). 
```{r, message = FALSE, warning = FALSE, echo = FALSE}
blockbusters <- read_csv("/Users/lilykasperek/Desktop/my-website/content/post/2022-03-22-first-post/Blockbusters_2019-1977.csv")
blockbusters
```

## Blockbuster Ratings: 1977 to 2019
```{r, message = FALSE, warning = FALSE, echo = FALSE}
blockbusters %>% group_by(mpaa_rating) %>%
  summarise(n = n()) 

blockbusters1 <- blockbusters %>% filter(!is.na(mpaa_rating)) %>%
  rename(Film = 'film_title')
  
ggplot(data = blockbusters1, aes(x = release_year, y = imdb_rating, colour = mpaa_rating,
                                          label = Film)) +
  geom_point() +
  facet_wrap(~mpaa_rating) +
  geom_smooth(se = FALSE, method = 'lm') +
  labs(y = "IMDB Rating",
       x = "Release Year",
       colour = "MPAA Rating",
       title = "Blockbuster Ratings: 1977 to 2019") +
  theme_hc() +
  scale_colour_brewer(palette = "Dark2") +
  theme(plot.title = element_text(family = "mono",
                                  face = "italic",
                                  margin = margin(t = 20, b = 20)),
        axis.ticks = element_blank(),
        axis.title = element_text(family = "mono",
                                  face = "italic"),
        axis.text = element_text(family = "mono"),
        legend.box.background = element_rect(),
        legend.text = element_text(family = "mono"),
        legend.title = element_text(family = "mono",
                                    face = "italic"),
        axis.title.y = element_text(margin = margin(r = 20)),
        axis.title.x = element_text(margin = margin(t = 20, b = 10)),
        strip.text = element_text(family = "mono",
                                  face = "bold"))

blockbusters %>% group_by(mpaa_rating) %>%
  summarise(n = n()) %>%
  filter(!is.na(mpaa_rating))
```

## Has the Budget for Blockbusters Increased Throughout Time? 
```{r}
ggplot(data = blockbusters, aes(x = release_year, y = film_budget, colour = release_year)) +
  geom_point() +
  geom_smooth(se = FALSE, method = "lm", colour = "black") +
  labs(x = "Release Year",
       y = "Film Budget",
       title = "Has the Budget for Blockbuster Films Increased Throughout Time?",
       subtitle = "Film Budget for Blockbusters: 1977-2019") +
  theme_bw() +
  scale_colour_viridis_c() +
  theme(legend.position = "none",
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  margin = margin(c(t = 50, b = 50)),
                                  vjust = 10),
        plot.subtitle = element_text(family = "mono",
                                     face = "italic",
                                     vjust = 5),
        axis.title = element_text(family = "mono",
                                  face = "bold"),
        axis.text = element_text(family = "mono"),
        axis.ticks = element_blank(),
        axis.title.x = element_text(margin = margin(c(l = 20))),
        axis.title.y = element_text(margin = margin(c(t = 20, b = 20, r = 20)))) 
## need to add more to this visualization 
```

## Which American/Domestic Distributor Has Produced the Most Blockbusters 1977-2019
```{r}
blockbusters3 <- blockbusters %>% group_by(domestic_distributor) %>%
  summarise(n = n()) %>%
  arrange(desc(n)) %>%
  mutate(order = fct_reorder(.f = domestic_distributor, .x = n)) %>%
  filter(!n == 1)

ggplot(data = blockbusters3, aes(x = order, y = n, fill = order)) +
  geom_point() +
  geom_segment(aes(x = order, xend = order, y = 0, yend = n)) +
  coord_flip() +
  geom_label(data = blockbusters3, aes(label = n), show.legend = FALSE) +
  labs(x = "Amount of Films Produced",
       y = "Domestic Distributor",
       title = "Amount of Blockbusters Produced by Domestic Distributors: 1977-2019") +
  theme_bw() +
  theme(legend.position = "none",
        plot.title = element_text(family = "mono",
                                  face = "bold",
                                  margin = margin(c(t = 50)),
                                  vjust = 10),
        axis.title = element_text(family = "mono",
                                  face = "bold"),
        axis.text = element_text(family = "mono"),
        axis.text.y = element_text(face = "italic"),
        axis.ticks = element_blank(),
        axis.title.x = element_text(margin = margin(c(b = 20))),
        axis.title.y = element_text(margin = margin(c(t = 30, r = 30))))
```

## Work in Progress 
```{r}
blockbusters
interest <- blockbusters %>% mutate(rank = rank(desc(imdb_rating))) %>%
  select(rank, everything()) %>%
  arrange(rank) %>%
  slice(1:5) %>%
  mutate(film_title = fct_recode(film_title, 
                                 LOTR_The_Return_Of_The_King = "The Lord of the Rings: The Return of the King",
                                 LOTR_Fellowship_Of_The_Ring = "The Lord of the Rings: The Fellowship of the Ring"))
interest 

interest2 <- blockbusters %>% mutate(rank = rank(imdb_rating)) %>%
  select(rank, everything()) %>%
  arrange(rank) %>%
  slice(1:5)
interest2

library(ggrepel)
ggplot(data = interest, aes(x = release_year, y = domestic_gross)) +
  geom_point(aes(colour = imdb_rating)) +
  geom_label_repel(data = interest, aes(label = film_title)) +
  geom_point(data = interest2, aes(x = release_year, y = domestic_gross, colour = imdb_rating)) +
  geom_label_repel(data = interest2, aes(label = film_title))
```

## History of Rock
```{r, message = FALSE, warning = FALSE, echo = FALSE}
library(tidyverse)
history_of_rock <- read_csv("/Users/lilykasperek/Desktop/my-website/content/post/2022-03-22-first-post/history-of-rock-spotify.csv")
history_of_rock
```

## Most Popular Nirvana Songs 
```{r}
history_of_rock %>% group_by(artist) %>%
  summarise(n = n()) %>% arrange(desc(n)) 

nirvana <- history_of_rock %>% rename(Popularity = 'popularity') %>%
  filter(artist == "Nirvana") %>% arrange(desc(Popularity)) %>%
  mutate(order = fct_reorder(.f = name, .x = Popularity)) %>%
  rename(Release_Date = 'release_date')

nirvana %>% select(order, everything())

plot3 <- ggplot(data = nirvana, aes(x = order, y = Popularity, label = Popularity, colour = Popularity)) +
  geom_point() +
  geom_segment(aes(x = order, xend = order, y = 0, yend = Popularity)) +
  coord_flip() +
  labs(title = "Most Popular Nirvana Songs: 1991-2018",
       colour = "Popularity", 
       x = " ",
       y = " ") +
  theme_bw() +
  scale_colour_viridis_b() +
  theme(legend.position = "none")

ggplotly(plot3, tooltip = "label")
```

## Trying to Make Density Ridges Plot 
```{r}
## install.packages("ggridges")
library(ggridges)

nirvana_small <- nirvana %>% slice(1:5) %>%
  mutate(order = fct_reorder(.f = name, .x = valence))
ggplot(data = nirvana_small, aes(x = order, y = valence)) +
  geom_density_ridges() +
  coord_flip() +
  labs(x = "Title",
       y = "Valence")
```

## Works in Progress - Simple Visualizations
```{r}
nirvana_line <- nirvana %>% rename(Title = 'name')
plot10 <- ggplot(data = nirvana_line, aes(x = Release_Date, y = Popularity, label = Title)) +
  geom_line() +
  geom_point(colour = "darkolivegreen") +
  labs(x = "Release Date",
       y = "Popularity",
       title = "Comparing Popularity by Release Date") +
  theme_bw() +
  theme(legend.position = "none")

ggplotly(plot10, tooltip = "label")

table <- history_of_rock %>% group_by(artist) %>%
  summarise(mean = mean(popularity)) %>%
  arrange(desc(mean)) %>%
  slice(1:10)

top10 <- history_of_rock %>% arrange(desc(popularity)) %>% slice(1:10)
```

## Unemployment Data Set
```{r}
library(lubridate)
unemployment <- read_csv("data/unemployment_data_us.csv")
ggplot(data = unemployment, aes(x = Date, y = Professional_Degree)) +
  geom_point()
```
